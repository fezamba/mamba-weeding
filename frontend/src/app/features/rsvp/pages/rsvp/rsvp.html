<div class="container">
  <h1>RSVP Mamba Wedding üêçüíç</h1>

  <div *ngIf="!guestData() && !successMessage()">
    <form [formGroup]="lookupForm" (ngSubmit)="onLookup()">
      <label for="code">Digite o c√≥digo do seu convite:</label>
      <input id="code" type="text" formControlName="codigoConvite" placeholder="Ex: MAMBA-123" />
      
      <button type="submit" [disabled]="lookupForm.invalid || isLoading()">
        {{ isLoading() ? 'Buscando...' : 'Buscar Convite' }}
      </button>
    </form>
    
    <p class="error" *ngIf="errorMessage()">{{ errorMessage() }}</p>
  </div>

  <div *ngIf="guestData() && !successMessage()">
    <h2>Ol√°, {{ guestData()?.nomeCompleto }}!</h2>
    <p>Situa√ß√£o atual: <strong>{{ guestData()?.statusConvite }}</strong></p>

    <form [formGroup]="actionForm">
      <div class="form-group">
        <label>Email:</label>
        <input type="email" formControlName="email" />
      </div>

      <div class="form-group">
        <label>Telefone/WhatsApp:</label>
        <input type="text" formControlName="telefone" />
      </div>

      <div class="form-group">
        <label>Observa√ß√µes (restri√ß√µes alimentares, etc):</label>
        <textarea formControlName="observacoes"></textarea>
      </div>

      <div class="actions">
        <button type="button" (click)="submitRsvp(true)" class="btn-confirm" [disabled]="isLoading()">
          Confirmar Presen√ßa
        </button>
        <button type="button" (click)="submitRsvp(false)" class="btn-decline" [disabled]="isLoading()">
          Recusar
        </button>
      </div>
    </form>
  </div>

  <div *ngIf="successMessage()" class="success-box">
    <h3>{{ successMessage() }}</h3>
    <button (click)="successMessage.set(''); guestData.set(null); lookupForm.reset()">Voltar</button>
  </div>
</div>